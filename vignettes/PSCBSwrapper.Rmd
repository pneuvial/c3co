---
title: "Using c3co with PSCBS data"
author: "Morgane Pierre-Jean and Pierre Neuvial"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
bibliography: c3co.bib
nocite: | 
  @olshen11parent-specific

vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEncoding{UTF-8}
---

## Introduction

This document provides a brief tutorial for using the c3co package on data segmented by PSCBS.

```{r}
library("c3co")
library("c3co.data")
```

## Using wrapper

In this document we run c3co on a public data set in the  \code{PSCBS} format, which has been saved into the \code{c3co.data} package. The \code{PSCBSwrapper} function segments and saves data from \code{PSCBS} format to c3co format.

```{r, eval=TRUE}
data("PSCBSdata", package="c3co.data")
output.dir <- R.utils::Arguments$getWritablePath("outputPSCBS")
PSCBSwrapper(PSCBSdata, output.dir=output.dir, stat="C1C2")
```

## Run c3co ##
Now, you can run c3co by using this line:
```{r, message=FALSE, eval=TRUE}
lambda.grid <- seq(from=1e-6, to =1e-4, length=5)
parameters.grid <- list(lambda=lambda.grid, nb.arch=2:4)
resc3co <- c3co(dat=NULL, parameters.grid, segDat=file.path(output.dir, "segDat.rds"))
```
```{r, fig.width=7, fig.height=5, eval=TRUE}
Wplot(resc3co, idxBest = 2)
```
```{r, fig.width=7, fig.height=5, eval=TRUE}
dat <- PSCBSdata
```

```{r, fig.width=7, fig.height=5, eval=TRUE}
df <- createZdf(resc3co, chromosomes=c(1,2), idxBest=2)
```

```{r, fig.width=7, fig.height=5, eval=TRUE}
Zplot(df, scalePosToMb=TRUE)
```

## Session Information

```{r}
sessionInfo()
```


## References


